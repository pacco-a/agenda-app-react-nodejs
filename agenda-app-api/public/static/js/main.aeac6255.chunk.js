(this["webpackJsonpagenda-app-client"]=this["webpackJsonpagenda-app-client"]||[]).push([[0],{116:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var a=n(19),c=n(14),r=n.n(c),s=n(13),o=n(8),i=n.n(o),u=n(16),d=n(25),l=n.n(d),j=n(0),b=(n(116),n(33)),p=n(15),f=n(48),O=n(24),m=n(9),x=n.n(m),h={currentDate:x()().format("YYYY-MM-DD"),currentTasks:[]},k=Object(O.b)("tasks/fetchCurrentDateTasks",function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("api call for fetch tasks"),e.next=3,l.a.get("/api/tasks/week?date=".concat(x()(t).format("YYYY-MM-DD")));case 3:return n=e.sent,console.log(n.data),e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),g=Object(O.b)("tasks/addOneTask",function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("api call for add one task"),e.next=3,l.a.post("/api/tasks",t);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),v=Object(O.b)("tasks/updateOneTask",function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw new Error("ITask objects needed ID for update request");case 2:return e.next=4,l.a.patch("/api/tasks",t);case 4:return n=e.sent,e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y=Object(O.c)({name:"tasks",initialState:h,reducers:{setDate:function(e,t){e.currentDate=t.payload}},extraReducers:function(e){e.addCase(k.fulfilled,(function(e,t){e.currentTasks=t.payload})),e.addCase(g.fulfilled,(function(e,t){var n=t.payload;0===x()(n.date).day()?x()("".concat(e.currentDate.substring(0,10)," 00:00")).isSame(x()("".concat(n.date.substring(0,10)," 00:00")).subtract(1,"day"),"week")&&e.currentTasks.push(n):x()("".concat(e.currentDate.substring(0,10)," 00:00")).isSame(n.date,"week")&&e.currentTasks.push(n)})),e.addCase(v.fulfilled,(function(e,t){var n=t.payload;e.currentTasks=e.currentTasks.map((function(e){return e.id===n.id?n:e}))}))}}),D=y.actions.setDate,Y=y.reducer,I=Object(O.c)({name:"ui",initialState:{addTaskPopupOn:!1,taskItemPopupOn:!1,loginPopupOn:!1,taskItemPopup:{resume:"none",color:"none",date:"none",details:"none",done:!1}},reducers:{toggleAddTaskPopup:function(e){e.addTaskPopupOn=!e.addTaskPopupOn},toggleTaskItemPopup:function(e){e.taskItemPopupOn=!e.taskItemPopupOn},setTaskItem:function(e,t){e.taskItemPopup=t.payload},setLoginPopupOn:function(e,t){e.loginPopupOn=t.payload}}}),w=I.actions,C=w.setLoginPopupOn,M=w.toggleAddTaskPopup,T=w.toggleTaskItemPopup,P=w.setTaskItem,S=I.reducer,L=n(4),E=function(e){var t=e.customOnClick,n=e.initColor;return Object(L.jsxs)("div",{onClick:function(e){var n=e.target;if(n.classList.contains("color-box")){if(!n.parentElement)throw new Error("no parent ?");for(var a=0,c=Array.from(n.parentElement.children);a<c.length;a++){c[a].classList.remove("color-selected")}n.classList.add("color-selected"),t(n.classList[1])}},className:"color-selector",children:[Object(L.jsx)("div",{className:"color-box red color-red ".concat("red"===n&&"color-selected"," ")}),Object(L.jsx)("div",{className:"color-box blue color-blue ".concat("blue"===n&&"color-selected"," ")}),Object(L.jsx)("div",{className:"color-box orange color-orange ".concat("orange"===n&&"color-selected"," ")}),Object(L.jsx)("div",{className:"color-box green color-green ".concat("green"===n&&"color-selected"," ")}),Object(L.jsx)("div",{className:"color-box pink color-pink ".concat("pink"===n&&"color-selected"," ")})]})},N=function(){var e=Object(f.a)(),t=e.register,n=e.handleSubmit,a=Object(s.c)((function(e){return e.tasks})).currentDate,c=Object(s.b)(),r=Object(j.useState)("blue"),o=Object(p.a)(r,2),i=o[0],u=o[1];return Object(L.jsx)("div",{onMouseDown:function(e){"addtask-form-container"===e.target.id&&c(M())},id:"addtask-form-container",children:Object(L.jsxs)("form",{onSubmit:n((function(e){var t={resume:e.resume,date:e.date,details:e.details,done:!1,color:i};c(g(t)),c(M())})),children:[Object(L.jsx)("input",Object(b.a)({type:"text",placeholder:"nom de la t\xe2che",defaultValue:""},t("resume"))),Object(L.jsx)("input",Object(b.a)({type:"date",defaultValue:a},t("date"))),Object(L.jsx)("textarea",Object(b.a)({placeholder:"details de la tache",defaultValue:""},t("details"))),Object(L.jsx)(E,{customOnClick:function(e){u(e)},initColor:i}),Object(L.jsx)("button",{type:"submit",children:"Ajouter"})]})})},A=n(141),F=Object(O.c)({name:"users",initialState:{isLogIn:!1,username:""},reducers:{setIsLogin:function(e,t){e.isLogIn=t.payload}}}),V=F.actions.setIsLogin,q=F.reducer,z=function(){var e=Object(s.b)();return Object(L.jsxs)("header",{children:[Object(L.jsx)("h1",{children:"Agenda App"}),Object(L.jsx)(A.a,{variant:"outlined",onClick:function(t){e(M())},children:"Ajouter une t\xe2che"}),Object(L.jsx)(A.a,{variant:"outlined",color:"secondary",onClick:function(t){l.a.get("/api/users/logout").then((function(){e(V(!1)),e(C(!0))})).catch((function(e){console.error(e)}))},children:"Deconnexion"})]})},J=function(){var e=Object(s.b)(),t=Object(j.useState)(""),n=Object(p.a)(t,2),a=n[0],c=n[1],r=Object(f.a)(),o=r.register,d=r.handleSubmit,O=function(){var t=Object(u.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.a.post("/api/login",{username:n.username,password:n.password});case 3:c(""),e(V(!0)),e(C(!1)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),c("Une erreur est survenue, est-ce la bonne combinaison login/mot de passe ?");case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}();return Object(L.jsx)("div",{id:"login-popup-container",children:Object(L.jsxs)("form",{onSubmit:d(O),children:[Object(L.jsx)("p",{children:"Entrez un login et un mot de passe pr\xe9-existant pour acc\xe8der a vos t\xe2ches."}),Object(L.jsx)("p",{children:"Entrez un nouveau login et mot de passe pour cr\xe9er votre agenda electronique."}),Object(L.jsx)("p",{children:"NOTE : les mots de passe ne sont pas chiffr\xe9s dans la base de donn\xe9e, pensez utiliser un mot de passe unique."}),a,Object(L.jsx)("input",Object(b.a)({type:"text",placeholder:"LOGIN"},o("username"))),Object(L.jsx)("input",Object(b.a)({type:"password",placeholder:"MOT DE PASSE"},o("password"))),Object(L.jsx)("button",{type:"submit",children:"Go"})]})})},B=n(145),G=function(e){var t=e.task,n=Object(s.b)();return Object(L.jsx)("div",{onClick:function(e){n(P(t)),n(T())},className:"schedule-item color-".concat(t.color," ").concat(t.done&&"done"),children:t.resume})},R=function(e){var t=e.dayIdentifier,n=e.tasks,a=Object(j.useState)(!1),c=Object(p.a)(a,2),r=c[0],o=c[1],i=Object(s.c)((function(e){return e.tasks})).currentDate;return Object(j.useEffect)((function(){o(!1)}),[i]),Object(L.jsxs)("div",{id:"".concat(t,"-column"),className:"schedule-column",children:[Object(L.jsx)("div",{onClick:function(e){o(!r)},className:"schedule-column-header ".concat(r&&"collapsed"),children:t}),!r&&n.map((function(e){return Object(L.jsx)(G,{task:e},e.id)}))]})},U=function(){var e=Object(s.c)((function(e){return e.tasks})),t=e.currentTasks,n=e.currentDate,a=Object(s.c)((function(e){return e.users})).isLogIn,c=Object(s.b)();Object(j.useEffect)((function(){console.log(a),a&&c(k(n))}),[n,a,c]);var r=function(e){return 0!==x()("".concat(n.substring(0,10)," 00:00")).day()?"".concat(x()("".concat(n.substring(0,10)," 00:00")).day(e).format("DD/MM")):"".concat(x()("".concat(n.substring(0,10)," 00:00")).subtract(1,"day").day(e).format("DD/MM"))};return Object(L.jsxs)(B.a,{variant:"outlined",id:"schedule-container",children:[Object(L.jsx)(R,{dayIdentifier:"Lundi ".concat(r(1)),tasks:t.filter((function(e){return 1===x()("".concat(e.date.substring(0,10)," 00:00")).day()}))}),Object(L.jsx)(R,{dayIdentifier:"Mardi ".concat(r(2)),tasks:t.filter((function(e){return 2===x()("".concat(e.date.substring(0,10)," 00:00")).day()}))}),Object(L.jsx)(R,{dayIdentifier:"Mercredi ".concat(r(3)),tasks:t.filter((function(e){return 3===x()("".concat(e.date.substring(0,10)," 00:00")).day()}))}),Object(L.jsx)(R,{dayIdentifier:"Jeudi ".concat(r(4)),tasks:t.filter((function(e){return 4===x()("".concat(e.date.substring(0,10)," 00:00")).day()}))}),Object(L.jsx)(R,{dayIdentifier:"Vendredi ".concat(r(5)),tasks:t.filter((function(e){return 5===x()("".concat(e.date.substring(0,10)," 00:00")).day()}))}),Object(L.jsx)(R,{dayIdentifier:"Autre",tasks:t.filter((function(e){return 6===x()("".concat(e.date.substring(0,10)," 00:00")).day()||0===x()("".concat(e.date.substring(0,10)," 00:00")).day()}))})]})},H=n(146),K=n(52),Q=function(){var e=Object(s.c)((function(e){return e.tasks})).currentDate,t=Object(s.b)();return Object(L.jsxs)("div",{id:"schedule-navigator",children:[Object(L.jsx)(A.a,{variant:"contained",onClick:function(n){t(D(x()("".concat(e.substring(0,10)," 00:00")).subtract(7,"days").format("YYYY-MM-DD")))},children:Object(L.jsx)(K.a,{})}),Object(L.jsx)(H.a,{format:"DD/MM/YYYY",value:x()(e),onChange:function(e){e&&t(D(e.format("YYYY-MM-DD")))}}),Object(L.jsx)(A.a,{onClick:function(e){t(D(x()(Date.now()).format("YYYY-MM-DD")))},variant:"contained",children:"Semaine actuelle"}),Object(L.jsx)(A.a,{variant:"contained",onClick:function(n){t(D(x()("".concat(e.substring(0,10)," 00:00")).add(7,"days").format("YYYY-MM-DD")))},children:Object(L.jsx)(K.b,{})})]})},W=function(){var e=Object(s.c)((function(e){return e.ui})).taskItemPopup,t=Object(s.b)(),n=Object(j.useState)(e.resume),a=Object(p.a)(n,2),c=a[0],r=a[1],o=Object(j.useState)(x()("".concat(e.date.substring(0,10)," 00:00")).format("YYYY-MM-DD")),i=Object(p.a)(o,2),u=i[0],d=i[1],l=Object(j.useState)(e.details),b=Object(p.a)(l,2),f=b[0],O=b[1],m=Object(j.useState)(e.color),h=Object(p.a)(m,2),k=h[0],g=h[1],y=Object(j.useState)(e.done),D=Object(p.a)(y,2),Y=D[0],I=D[1];return Object(L.jsx)("div",{onMouseDown:function(e){"taskitem-popup-container"===e.target.id&&t(T())},id:"taskitem-popup-container",children:Object(L.jsxs)("form",{onSubmit:function(n){n.preventDefault(),t(v({id:e.id,color:k,date:u,details:f,done:Y,resume:c})),t(T())},id:"taskitem-popup",children:[Object(L.jsx)("input",{type:"text",name:"resume",placeholder:"nom de la t\xe2che",value:c,onChange:function(e){return r(e.target.value)}}),Object(L.jsx)("input",{type:"date",name:"date",value:u,onChange:function(e){return d(e.target.value)}}),Object(L.jsx)("textarea",{name:"details",placeholder:"details de la tache",value:f,onChange:function(e){return O(e.target.value)}}),Object(L.jsx)(E,{customOnClick:function(e){g(e)},initColor:k}),Object(L.jsxs)("div",{children:[Object(L.jsx)("label",{htmlFor:"done",children:"Fini : "}),Object(L.jsx)("input",{onChange:function(e){return I(e.target.checked)},checked:Y,type:"checkbox",name:"done"})]}),Object(L.jsx)("button",{type:"submit",children:"Modifier"})]})})};var X=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.ui})),n=t.addTaskPopupOn,a=t.taskItemPopupOn,c=t.loginPopupOn;return Object(j.useEffect)((function(){(function(){var t=Object(u.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.get("/api/users/islogin");case 2:t.sent.data?(e(C(!1)),e(V(!0))):(e(C(!0)),e(V(!1)));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),Object(L.jsxs)("div",{className:"App",children:[c&&Object(L.jsx)(J,{}),n&&Object(L.jsx)(N,{}),a&&Object(L.jsx)(W,{}),Object(L.jsxs)("div",{id:"main-container",children:[Object(L.jsx)(z,{}),Object(L.jsx)(Q,{}),Object(L.jsx)(U,{})]})]})},Z=Object(O.a)({reducer:{tasks:Y,ui:S,users:q}}),$=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,150)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))},_=n(70);r.a.render(Object(L.jsx)(s.a,{store:Z,children:Object(L.jsx)(a.a,{utils:_.a,children:Object(L.jsx)(X,{})})}),document.getElementById("root")),$()}},[[118,1,2]]]);
//# sourceMappingURL=main.aeac6255.chunk.js.map